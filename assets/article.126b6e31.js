import{_ as g,s as r}from"./index.06e84b55.js";import{r as f,o as l,f as o,h as t,F as p,g as j,s as I,v,k as y,w as x,t as c,l as n,d as k,i as L}from"./vendor.3451bb13.js";const T={name:"author_article",data(){return{thisUsername:this.$route.params.username,isThisUser:this.$route.params.username==this.$store.state.username,thisItem:{},articleList:[],articlePage:{nextPage:1},subjectFrom:{subjectId:""},subjectList:[]}},methods:{loadArticleByUsername(i){r({url:"/api/article/list/"+this.$route.params.username,method:"get",params:{page:i}}).then(s=>{s.data.list!=null&&(this.articlePage=s.data,this.articleList=this.articleList.concat(s.data.list))})},loadSubjectList(){r({url:"/api/subject/username",method:"GET",params:{username:this.$route.params.username}}).then(i=>{this.subjectList=i.data.list})},insertArticleToSubject(){let i=this.subjectFrom.articleId,s=this.subjectFrom.subjectId;r({url:"/api/subject/article",method:"POST",params:{articleId:i,subjectId:s}}).then(b=>{this.thisItem.subjectId=s,this.$refs.close.click()})},updateArticleToSubject(){let i=this.subjectFrom.articleId,s=this.subjectFrom.subjectId;r({url:"/api/subject/article",method:"PUT",params:{articleId:i,subjectId:s}}).then(b=>{this.thisItem.subjectId=s;for(let h in this.subjectList){let a=this.subjectList[h];s==a.articleSubjectId&&(this.thisItem.subjectName=a.subjectName)}this.$refs.close.click()})},saveArticleToSubject(){this.thisItem.subjectId==null?this.insertArticleToSubject():this.updateArticleToSubject()},deleteArticle(i,s){r({url:"/api/article/"+i,method:"DELETE"}).then(b=>{this.articleList.splice(s,1)})},nextPage(){this.articlePage.isLastPage||this.loadArticleByUsername(this.articlePage.nextPage)}},mounted(){this.loadArticleByUsername(this.articlePage.nextPage),this.loadSubjectList()}},C={class:"list-group article-list"},S=["textContent"],P={class:"article-synopsis"},A={key:0},F={style:{background:"#efefef",padding:"0px 5px","border-radius":"10px",color:"#7d7d7d"}},U={style:{background:"#efefef",padding:"0px 5px","border-radius":"10px",color:"#7d7d7d"}},N={class:"btn-group float-end"},B=["onClick"],M=L("\u4FEE\u6539"),E=["onClick"],V=["onClick"],w={class:"list-group-item"},z={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},D={class:"modal-dialog"},G={class:"modal-content"},O=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},"\u6DFB\u52A0\u535A\u5BA2\u5230\u4E13\u8F91"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),q={class:"modal-body"},H=t("option",{value:""},"\u8BF7\u9009\u62E9",-1),J=["value"],K={class:"modal-footer"},Q={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",ref:"close"};function R(i,s,b,h,a,d){const m=f("router-link");return l(),o(p,null,[t("ul",C,[(l(!0),o(p,null,j(a.articleList,(e,u)=>(l(),o("li",{class:"list-group-item",key:u},[y(m,{to:{name:"article_info",params:{id:e.articleId}},class:"article-title"},{default:x(()=>[t("strong",null,[t("p",{textContent:c(e.title)},null,8,S)])]),_:2},1032,["to"]),t("div",P,c(e.synopsis),1),e.subjectName!=null?(l(),o("p",A,[t("span",F,"\u4E13\u8F91 : "+c(e.subjectName),1)])):n("",!0),t("span",U,c(e.createDate),1),t("div",N,[a.isThisUser?(l(),o("button",{key:0,class:"btn btn-outline-danger float-end",style:{padding:"0px 5px 0px 3px","font-size":"13px"},onClick:_=>d.deleteArticle(e.articleId,u)},"\u5220\u9664",8,B)):n("",!0),a.isThisUser?(l(),k(m,{key:1,class:"btn btn-outline-danger float-end",style:{padding:"0px 5px 0px 3px","font-size":"13px"},target:"_blank",to:{name:"article-editor",params:{id:e.articleId}}},{default:x(()=>[M]),_:2},1032,["to"])):n("",!0),e.subjectId==null&&a.isThisUser?(l(),o("button",{key:2,class:"btn btn-outline-success float-end",style:{padding:"0px 5px 0px 3px","font-size":"13px"},"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:_=>(a.subjectFrom.articleId=e.articleId,a.thisItem=e)},"\u6DFB\u52A0\u5230\u4E13\u8F91",8,E)):n("",!0),e.subjectId!=null&&a.isThisUser?(l(),o("button",{key:3,class:"btn btn-outline-warning float-end",style:{padding:"0px 5px 0px 3px","font-size":"13px"},"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:_=>(a.subjectFrom.articleId=e.articleId,a.thisItem=e)},"\u4FEE\u6539\u5230\u4E13\u8F91",8,V)):n("",!0)])]))),128)),t("li",w,[t("a",{onClick:s[0]||(s[0]=e=>d.nextPage())},"\u83B7\u53D6")])]),t("div",z,[t("div",D,[t("div",G,[O,t("div",q,[I(t("select",{class:"form-select","onUpdate:modelValue":s[1]||(s[1]=e=>a.subjectFrom.subjectId=e)},[H,(l(!0),o(p,null,j(a.subjectList,(e,u)=>(l(),o("option",{key:u,value:e.articleSubjectId},c(e.subjectName),9,J))),128))],512),[[v,a.subjectFrom.subjectId]])]),t("div",K,[t("button",Q,"\u5173\u95ED",512),t("button",{type:"button",class:"btn btn-primary",onClick:s[2]||(s[2]=(...e)=>d.saveArticleToSubject&&d.saveArticleToSubject(...e))},"\u4FDD\u5B58")])])])])],64)}var Y=g(T,[["render",R]]);export{Y as default};
