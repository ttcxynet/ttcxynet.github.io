import{_ as f,s as r}from"./index.11c52178.js";import{r as I,o as i,e as o,f as e,F as m,i as j,u as x,x as k,m as y,w as g,t as c,n,d as v,j as L}from"./vendor.610329c2.js";const C={name:"author_article",data(){return{thisUsername:this.$route.params.username,isThisUser:this.$route.params.username==this.$store.state.username,thisItem:{},articleList:[],articlePage:{nextPage:1},subjectFrom:{subjectId:""},subjectList:[]}},methods:{loadArticleByUsername(l){r({url:"/api/article/list/"+this.$route.params.username,method:"get",params:{page:l}}).then(s=>{s.data.list!=null&&(this.articlePage=s.data,this.articleList=this.articleList.concat(s.data.list))})},loadSubjectList(){r({url:"/api/subject/username",method:"GET",params:{username:this.$route.params.username}}).then(l=>{this.subjectList=l.data.list})},insertArticleToSubject(){let l=this.subjectFrom.articleId,s=this.subjectFrom.subjectId;r({url:"/api/subject/article",method:"POST",params:{articleId:l,subjectId:s}}).then(b=>{this.thisItem.subjectId=s,this.$refs.close.click()})},updateArticleToSubject(){let l=this.subjectFrom.articleId,s=this.subjectFrom.subjectId;r({url:"/api/subject/article",method:"PUT",params:{articleId:l,subjectId:s}}).then(b=>{this.thisItem.subjectId=s;for(let h in this.subjectList){let a=this.subjectList[h];s==a.subjectId&&(this.thisItem.subjectName=a.subjectName)}this.$refs.close.click()})},deleteArticle(l,s){r({url:"/api/article/"+l,method:"DELETE"}).then(b=>{this.articleList.splice(s,1)})},nextPage(){this.articlePage.isLastPage||this.loadArticleByUsername(this.articlePage.nextPage)}},mounted(){this.loadArticleByUsername(this.articlePage.nextPage),this.loadSubjectList()}},T={class:"list-group article-list"},P=["textContent"],F={class:"article-synopsis"},N={key:0},U={style:{background:"#efefef",padding:"0px 5px","border-radius":"10px",color:"#7d7d7d"}},A={style:{background:"#efefef",padding:"0px 5px","border-radius":"10px",color:"#7d7d7d"}},S={class:"btn-group float-end"},B=["onClick"],M=L("\u4FEE\u6539"),E=["onClick"],V=["onClick"],w={class:"list-group-item"},D={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},G={class:"modal-dialog"},O={class:"modal-content"},q=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"\u6DFB\u52A0\u535A\u5BA2\u5230\u4E13\u8F91"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),z={class:"modal-body"},H=e("option",{value:""},"\u8BF7\u9009\u62E9",-1),J=["value"],K={class:"modal-footer"},Q={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",ref:"close"};function R(l,s,b,h,a,d){const p=I("router-link");return i(),o(m,null,[e("ul",T,[(i(!0),o(m,null,j(a.articleList,(t,u)=>(i(),o("li",{class:"list-group-item",key:u},[y(p,{to:{name:"article_info",params:{id:t.articleId}},class:"article-title"},{default:g(()=>[e("strong",null,[e("p",{textContent:c(t.title)},null,8,P)])]),_:2},1032,["to"]),e("div",F,c(t.synopsis),1),t.subjectName!=null?(i(),o("p",N,[e("span",U,"\u4E13\u8F91 : "+c(t.subjectName),1)])):n("",!0),e("span",A,c(t.createDate),1),e("div",S,[a.isThisUser?(i(),o("button",{key:0,class:"btn btn-outline-danger float-end blog-btn",onClick:_=>d.deleteArticle(t.articleId,u)}," \u5220\u9664 ",8,B)):n("",!0),a.isThisUser?(i(),v(p,{key:1,class:"btn btn-outline-danger float-end blog-btn",target:"_blank",to:{name:"article-editor",params:{id:t.articleId}}},{default:g(()=>[M]),_:2},1032,["to"])):n("",!0),t.subjectName==null&&a.isThisUser?(i(),o("button",{key:2,class:"btn btn-outline-success float-end blog-btn",style:{},"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:_=>(a.subjectFrom.articleId=t.articleId,a.thisItem=t)}," \u6DFB\u52A0\u5230\u4E13\u8F91 ",8,E)):n("",!0),t.subjectName!=null&&a.isThisUser?(i(),o("button",{key:3,class:"btn btn-outline-warning float-end blog-btn","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:_=>(a.subjectFrom.articleId=t.articleId,a.thisItem=t)}," \u4FEE\u6539\u5230\u4E13\u8F91 ",8,V)):n("",!0)])]))),128)),e("li",w,[e("a",{onClick:s[0]||(s[0]=t=>d.nextPage())},"\u83B7\u53D6")])]),e("div",D,[e("div",G,[e("div",O,[q,e("div",z,[x(e("select",{class:"form-select","onUpdate:modelValue":s[1]||(s[1]=t=>a.subjectFrom.subjectId=t)},[H,(i(!0),o(m,null,j(a.subjectList,(t,u)=>(i(),o("option",{key:u,value:t.subjectId},c(t.subjectName),9,J))),128))],512),[[k,a.subjectFrom.subjectId]])]),e("div",K,[e("button",Q," \u5173\u95ED ",512),e("button",{type:"button",class:"btn btn-primary",onClick:s[2]||(s[2]=(...t)=>d.updateArticleToSubject&&d.updateArticleToSubject(...t))}," \u4FDD\u5B58 ")])])])])],64)}var Y=f(C,[["render",R]]);export{Y as default};
