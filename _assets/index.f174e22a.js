let t=document.createElement("style");t.innerHTML=".W33{width:33%}.W34{width:34%}.W100{width:100%}.mb10px{margin-bottom:10px}body,html{overflow:hidden}",document.head.appendChild(t);import{s as e,o as a,c as o,b as l,h as n,j as r,i as s,f as d,F as i,r as p,g as c}from"./index.5e95bf68.js";function u(t){this.message=t}u.prototype=new Error,u.prototype.name="InvalidCharacterError";var m="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new u("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,o,l=0,n=0,r="";o=e.charAt(n++);~o&&(a=l%4?64*a+o:o,l++%4)?r+=String.fromCharCode(255&a>>(-2*l&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return r};function g(t){this.message=t}function b(t,e){if("string"!=typeof t)throw new g("Invalid token specified");var a=!0===(e=e||{}).header?0:1;try{return JSON.parse(function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(m(e).replace(/(.)/g,(function(t,e){var a=e.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a})))}catch(t){return m(e)}}(t.split(".")[a]))}catch(t){throw new g("Invalid token specified: "+t.message)}}g.prototype=new Error,g.prototype.name="InvalidTokenError";var h={name:"login",data:()=>({type:"dl",loginData:{username:"",password:"",mail:"",password1:"",rememberMe:!0}}),components:{},methods:{login(){e({url:"/api/authenticate",method:"post",data:this.loginData}).then((t=>{if(200===t.code){let e=b(t.jwt_token);localStorage.setItem("token",t.jwt_token),localStorage.setItem("author",JSON.stringify(e.author)),this.$router.push({path:"/author/"+e.sub})}}))},sendMail(){e({url:"/api/mail-verify",method:"post",params:{mail:this.loginData.username}}).then((t=>{alert(t.message)}))},register(){this.loginData.password===this.loginData.password1?e({url:"/api/register",method:"post",data:this.loginData}).then((t=>{alert(t.data)})):alert("两次密码不一致")}},mounted(){localStorage.removeItem("token"),localStorage.removeItem("author")}};const f={key:0,id:"loginModal",class:"modal-dialog"},y={class:"modal-content"},w=l("div",{class:"modal-header"},[l("h4",{class:"modal-title text-center"},"登录")],-1),v={id:"model-body",class:"modal-body"},k=l("label",null,"邮箱/用户名：",-1),D={class:"form-group"},W=l("label",null,"密码：",-1),x={class:"form-group"},C={class:"modal-footer"},I={class:"btn-group W100 mb10px"},S={class:"btn-group W100 mb10px"},U={class:"btn-group W100"},E=c("返回首页"),V={key:1,class:"modal-dialog"},j={class:"modal-content"},M=l("div",{class:"modal-header"},[l("h4",{class:"modal-title text-center"},"注册")],-1),_={id:"model-body",class:"modal-body"},O=l("label",null,"邮箱：",-1),T={class:"input-group"},z=l("label",null,"密码：",-1),A={class:"form-group"},J=l("label",null,"确认密码：",-1),N={class:"form-group"},F={class:"modal-footer"},H={class:"btn-group W100 mb10px"},L={class:"btn-group W100 mb10px"},R={class:"btn-group W100"},$=c("返回首页");h.render=function(t,e,c,u,m,g){const b=p("router-link");return a(),o(i,null,["dl"==m.type?(a(),o("div",f,[l("div",y,[w,l("div",v,[k,l("div",D,[n(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>m.loginData.username=t),placeholder:"邮箱/用户名",autocomplete:"off",class:"form-control"},null,512),[[r,m.loginData.username]])]),W,l("div",x,[n(l("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=t=>m.loginData.password=t),placeholder:"密码",autocomplete:"off",class:"form-control"},null,512),[[r,m.loginData.password]])])]),l("div",C,[l("div",I,[l("button",{type:"button",class:"btn btn-primary W100",onClick:e[3]||(e[3]=t=>g.login())},"登录")]),l("div",S,[l("button",{type:"button",class:"btn btn-primary W100",onClick:e[4]||(e[4]=t=>m.type="zc")},"注册")]),l("div",U,[l(b,{to:"/",type:"button",class:"btn btn-default W100"},{default:s((()=>[E])),_:1})])])])])):d("",!0),"zc"==m.type?(a(),o("div",V,[l("div",j,[M,l("div",_,[O,l("div",T,[n(l("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=t=>m.loginData.mail=t),placeholder:"邮箱号",autocomplete:"off",class:"form-control"},null,512),[[r,m.loginData.mail]])]),z,l("div",A,[n(l("input",{type:"password","onUpdate:modelValue":e[6]||(e[6]=t=>m.loginData.password=t),placeholder:"密码",autocomplete:"off",class:"form-control"},null,512),[[r,m.loginData.password]])]),J,l("div",N,[n(l("input",{type:"password","onUpdate:modelValue":e[7]||(e[7]=t=>m.loginData.password1=t),placeholder:"确认密码",autocomplete:"off",class:"form-control"},null,512),[[r,m.loginData.password1]])])]),l("div",F,[l("div",H,[l("button",{type:"button",class:"btn btn-primary W100",onClick:e[8]||(e[8]=t=>g.register())},"注册")]),l("div",L,[l("button",{type:"button",class:"btn btn-primary W100",onClick:e[9]||(e[9]=t=>m.type="dl")},"登录")]),l("div",R,[l(b,{to:"/",type:"button",class:"btn btn-default W100"},{default:s((()=>[$])),_:1})])])])])):d("",!0)],64)};export default h;
